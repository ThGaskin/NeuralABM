# ======================================================================================================================
#  ╦  ╦╔═╗╦═╗╦╔═╗╔╗ ╦  ╔═╗╔═╗
#  ╚╗╔╝╠═╣╠╦╝║╠═╣╠╩╗║  ║╣ ╚═╗
#   ╚╝ ╩ ╩╩╚═╩╩ ╩╚═╝╩═╝╚═╝╚═╝
# ======================================================================================================================

.variables:
  colors: &colors
    yellow:         &yellow           '#F5DDA9'
    darkblue:       &darkblue         '#2F7194'
    red:            &red              '#ec7070'
    skyblue:        &skyblue          '#97c3d0'
    darkgreen:      &darkgreen        '#48675A'
    lightbrown:     &lightbrown       '#C6BFA2'
    orange:         &orange           '#EC9F7E'
    lightgreen:     &lightgreen       '#AFD8BC'
    grey:           &grey             '#3D4244'
    pink:           &pink             '#F8A6A6'
    purple:         &purple           'purple'

  page_widths:
    full_width:     &full_width       7.00787402
    half_width:     &half_width       !expr 7.00787402 / 2
    third_width:    &third_width      !expr 7.00787402 / 3
    quarter_width:  &quarter_width    !expr 7.00787402 / 4
    fifth_width:    &fifth_width      !expr 7.00787402 / 5

  true_values:
    k_S:            &k_S              0.192
    k_E:            &k_E              1.69
    k_I:            &k_I              0.08
    k_R:            &k_R              0.03
    k_SY:           &k_SY             0.645
    k_H:            &k_H              0.01
    k_C:            &k_C              0.173
    k_D:            &k_D              0.3
    k_CT:           &k_CT             1.2

# ======================================================================================================================
#  ╔═╗╦  ╔═╗╔╦╗╔═╗
#  ╠═╝║  ║ ║ ║ ╚═╗
#  ╩  ╩═╝╚═╝ ╩ ╚═╝
# ======================================================================================================================
densities_from_marginals:
  based_on: densities_from_marginals
  dag_options:
    define:
      num_samples: 1000

densities_from_joint:
  based_on: densities_from_joint
  dag_options:
    define:
      step_size: !slice [~, ~, 50]

# Loss for each seed
loss:
  based_on:
    - .creator.multiverse
    - .plot.facet_grid.line
  select_and_combine:
    fields:
      data: loss
  hue: seed
  x: time
  style:
    figure.figsize: [ *full_width, *half_width ]
  helpers:
    set_legend:
      use_legend: False
    set_scales:
      y: log

# Marginals of the parameters
marginals: !pspace
  based_on: marginals_mv
  dag_options:
    define:
      parameter_idx: !sweep
        default: 0
        range: [9]
  style:
    figure.figsize: [ *third_width, *quarter_width ]

# Predicted parameters
predictions:
  based_on: predictions_mv
  col_wrap: 3
  add_legend: False
  lw: 1
  alpha: 0.5
  helpers:
    setup_figure:
      ncols: 3
      nrows: 3
    axis_specific:
      k_S:
        axis: [ 0, 0 ]
        set_hv_lines:
          hlines:
            - pos: *k_S
              color: *red
              linestyle: dotted
      k_E:
        axis: [ 1, 0 ]
        set_hv_lines:
          hlines:
            - pos: *k_E
              color: *red
              linestyle: dotted
      k_I:
        axis: [ 2, 0]
        set_hv_lines:
          hlines:
            - pos: *k_I
              color: *red
              linestyle: dotted
      k_R:
        axis: [ 0, 1 ]
        set_hv_lines:
          hlines:
            - pos: *k_R
              color: *red
              linestyle: dotted
      k_SY:
        axis: [ 1, 1 ]
        set_hv_lines:
          hlines:
            - pos: *k_SY
              color: *red
              linestyle: dotted
      k_H:
        axis: [ 2, 1 ]
        set_hv_lines:
          hlines:
            - pos: *k_H
              color: *red
              linestyle: dotted
      k_C:
        axis: [ 0, 2 ]
        set_hv_lines:
          hlines:
            - pos: *k_C
              color: *red
              linestyle: dotted
      k_D:
        axis: [ 1, 2 ]
        set_hv_lines:
          hlines:
            - pos: *k_D
              color: *red
              linestyle: dotted
      k_CT:
        axis: [ 2, 2 ]
        set_hv_lines:
          hlines:
            - pos: *k_CT
              color: *red
              linestyle: dotted
