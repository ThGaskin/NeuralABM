---
_:
  colors:
    yellow:           &yellow           '#F5DDA9'
    darkblue:         &darkblue         '#2F7194'
    red:              &red              '#ec7070'
    skyblue:          &skyblue          '#97c3d0'
    green:            &green            '#48675A'
    lightbrown:       &lightbrown       '#C6BFA2'
    orange:           &orange           '#EC9F7E'
    lightgreen:       &lightgreen       '#AFD8BC'
    grey:             &grey             '#3D4244'

    color_alpha:      &color_alpha      '#F5DDA9'
    color_beta:       &color_beta       '#2F7194'
    color_kappa:      &color_kappa      '#ec7070'
    line_color:       &line_color       '#ec7070'

  # Page widths in inches
  page_widths:
    full_width:    &full_width     7.00787402
    half_width:    &half_width     !expr 7.00787402 / 2
    third_width:   &third_width    !expr 7.00787402 / 3
    quarter_width: &quarter_width  !expr 7.00787402 / 4

  # True parameters
  true_parameters:
    alpha:        &alpha          1.2
    beta:         &beta           4
    kappa:        &kappa          2


# Plot the parameter predictions with true values and the training loss
predictions_and_loss:
  based_on:
    - .creator.universe
    - .plot.multiplot
  select:
    alpha:
      path: alpha
      transform:
        - .data: [ !dag_prev ]
    beta:
      path: beta
      transform:
        - .data: [ !dag_prev ]
    kappa:
      path: kappa
      transform:
        - .data: [ !dag_prev ]
    loss:
      path: loss
      transform:
        - xr.DataArray: [ !dag_prev ]
  compute_only: []
  file_ext: pdf
  to_plot:
    [0, 0]:
      - function: plt.plot
        args:
          - !dag_result alpha
        label: $\hat{\alpha}$
      - function: plt.plot
        args:
          - !dag_result beta
        label: $\hat{\beta}$
      - function: plt.plot
        args:
          - !dag_result kappa
        label: $\hat{\kappa}$
    [0, 1]:
      - function: plt.plot
        args:
          - !dag_result loss
        color: black
  style:
    figure.figsize: [*half_width, *half_width]
  helpers:
    setup_figure:
      nrows: 2
      sharex: True
    set_figlegend:
      use_legend: True
    axis_specific:
      predictions:
        axis: [0, 0]
        set_title:
          title: ' '
        set_hv_lines:
          hlines:
            - pos: *alpha
              color: *yellow
              zorder: -1
              linestyle: dotted
            - pos: *beta
              color: *darkblue
              zorder: -1
              linestyle: dotted
            - pos: *kappa
              color: *red
              zorder: -1
              linestyle: dotted
        set_labels:
          y:
            label: Predictions
            labelpad: 22
        set_legend:
          use_legend: True
          title: ~
          loc: 'best'
        set_texts:
          texts:
            - x: &x_loc 0.55
              y: *alpha
              s: '$\alpha$'
              color: *color_alpha
              bbox: &textbox
                facecolor: white
                linewidth: 0
                alpha: 1.0
                boxstyle: circle
                pad: 0.4
            - x: *x_loc
              y: *beta
              s: '$\beta$'
              color: *color_beta
              bbox:
                <<: *textbox
            - x: *x_loc
              y: *kappa
              s: '$\kappa$'
              color: *color_kappa
              bbox:
                <<: *textbox
        set_scales:
          x: log
        set_ticks:
          y:
            major:
              locs: [0, 3, 5]
        set_limits:
          x: [1, ~]
          y: [0, ~]
      loss:
        axis: [0, 1]
        set_title:
          title: ' '
        set_scales:
          y: log
        set_labels:
          x: iteration
          y: Training loss $J$
